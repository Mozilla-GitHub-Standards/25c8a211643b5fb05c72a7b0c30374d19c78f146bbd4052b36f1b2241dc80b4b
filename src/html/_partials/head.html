<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>{% block title %}{{ title }}{% endblock %}</title>
    <link rel="stylesheet" href="/stylesheets/app.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script>
      (function() {
        if (localStorage.getItem('languageSet') === null) {
          var language = window.navigator.language || window.navigator.userLanguage;
          var languageString = language.toLowerCase();

          if (languageString !== 'en-us' && languageString !== 'en') {
            var url = window.location.href;
            var protocol = window.location.protocol;
            var hostname = window.location.hostname;
            var port = window.location.port === '3000' ? ':3000' : '';
            var origin = window.location.origin || protocol + '//' + hostname + port;

            if (url.indexOf('/' + languageString + '/') === -1) {
              var targetDirectory = url.replace(origin, '');
              var targetURL = origin + '/' + languageString + targetDirectory;

              if (url !== targetURL) {
                localStorage.setItem('languageSet', true);
                window.location.replace(targetURL);
              }
            } else {
              localStorage.setItem('languageSet', true);
            }
          }
        }
      })();
    </script>
  </head>
  <body>